Ext.define("App.view.CheckCode",{extend:"Ext.form.field.Text",alias:"widget.checkcode",inputTyle:"codefield",codeUrl:Ext.BLANK_IMAGE_URL,isLoader:true,onRender:function(b,a){this.callParent(arguments);this.codeEl=b.createChild({tag:"img",src:Ext.BLANK_IMAGE_URL});this.codeEl.on("click",this.loadCodeImg,this);if(this.isLoader){this.loadCodeImg()}},alignErrorIcon:function(){this.errorIcon.alignTo(this.codeEl,"tl-tr",[2,0])},loadCodeImg:function(){this.codeEl.set({src:this.codeUrl})}});Ext.define("LoginWindow",{extend:"Ext.window.Window",title:"登陆系统",width:400,height:200,bodyPadding:10,collapsible:true,defaults:{border:false},closable:false,createFormPanel:function(){function c(){d.form.reset()}function a(){if(d.getForm().isValid()){d.getForm().submit({clientValidation:true,method:"post",url:"/PhoneTest/login",waitMsg:"正在提交数据，请稍候...",success:function(e,f){if(f.result.success){Ext.util.Cookies.set("MOBILE_TEST_SESSION",f.result.msg);window.location.href="/PhoneTest/home"}else{alert(f.result.msg)}},failure:function(e,f){Ext.MessageBox.alert("警告",f.result.msg)}})}}var b=Ext.create("App.view.CheckCode",{cls:"key",fieldLabel:"验证码",name:"randCode",id:"randCode",allowBlank:false,isLoader:true,blankText:"验证码不能为空",codeUrl:"verifycode.do",width:160,listeners:{specialKey:function(g,f){if(f.getKey()==Ext.EventObject.ENTER){a()}}}});var d=new Ext.form.Panel({defaultType:"textfield",frame:true,fieldDefaults:{labelAlign:"right",labelWidth:80},items:[{xtype:"textfield",name:"username",maxLength:15,fieldLabel:"帐 号",blankText:"帐号不能为空"},{xtype:"textfield",name:"pwd",maxLength:15,fieldLabel:"密 码",blankText:"密码不能为空",inputType:"password"},b],buttons:[{text:"确定",id:"btnLogin",handler:a},{text:"重置",id:"btnClear",handler:c}]});return d},initComponent:function(){this.callParent();this.fp=this.createFormPanel();this.add(this.fp)}});